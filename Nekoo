local Players           = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local CoreGui           = game:GetService("CoreGui")
local RunService        = game:GetService("RunService")
local UserInputService  = game:GetService("UserInputService")
local localPlayer       = Players.LocalPlayer

if getgenv().NEKO_RUNNING then return end
getgenv().NEKO_RUNNING = true

-- [[ ğŸš€ æ ¸å¿ƒæ¸…ç†èˆ‡åˆå§‹åŒ– ]]
local function NuclearClean()
    local targets = {"NEKO BF", "NekoUI", "NekoTerminal_Lib", "NekoStickyMenu", "NekoMainBtn"}
    for _, name in ipairs(targets) do
        local obj = CoreGui:FindFirstChild(name) or localPlayer:FindFirstChild("PlayerGui"):FindFirstChild(name)
        if obj then pcall(function() obj:Destroy() end) end
    end
end
NuclearClean()
task.wait(0.5)

-- [[ ğŸŒ æŠ“å– UI åº« ]]
local success, UIContent = pcall(function()
    return game:HttpGet("https://raw.githubusercontent.com/n9wmwd7ycz-crypto/-/refs/heads/main/Ui")
end)

if not success or UIContent == "" then 
    warn("ğŸ¾ NEKO: ç„¡æ³•å¾é›²ç«¯ç²å– UI è³‡æºå–µï¼")
    return 
end

local NekoLib = loadstring(UIContent)()
local myUI, screenGui = NekoLib.new("NEKO BF")

-- [[ é—œéµï¼šç¢ºä¿çª—å£ç”Ÿæˆå¾Œå†ç¹ªè£½å…§å®¹ ]]
task.wait(0.2) 

-- [[ å…¼å®¹æ€§æ›è¼‰ ]]
pcall(function() screenGui.Parent = CoreGui end)
if screenGui.Parent ~= CoreGui then screenGui.Parent = localPlayer.PlayerGui end

-- [[ ğŸŒ¸ é–‹å§‹ç¹ªè£½åŠŸèƒ½å€ (å¢åŠ å®‰å…¨ä¿è­·) ]]
local function BuildUI()
    local success, err = pcall(function()
        -- å…¬å‘Šç‹€æ…‹
        local TabInfo = myUI:Tab("å…¬å‘Š / ç‹€æ…‹")
        local MonSec  = TabInfo:Section("è²“å¥´å€‘æœ‰äº‹DCæ‰¾æˆ‘")
        local BtnAtk  = MonSec:Button("âš”ï¸ æ”»æ“Šï¼šOFF", function() end)
        local BtnMode = MonSec:Button("ğŸ§  æ¨¡å¼ï¼šNone", function() end)

        -- æˆ°é¬¥ç³»çµ±
        local TabFight = myUI:Tab("æˆ°é¬¥ç³»çµ±")
        local F_Core   = TabFight:Section("æ ¸å¿ƒæ”¶å‰²ä¸­å¿ƒ")
        F_Core:Toggle("å•Ÿå‹•ç¥åˆ€é€£æ“Š (FastAttack)", function(s)
            _G.NekoAttack = s
            if s and _G.Settings.Mode == "None" then _G.Settings.Mode = "All" end
        end)
        F_Core:Toggle("é–‹å•Ÿè²“æŠ“æ‹‰æ€ª (Pull)", function(s) _G.Settings.PullEnemies = s end)
        F_Core:Toggle("è‡ªå‹•è¦ºé†’ V4", function(s) _G.AutoV4 = s end)
        F_Core:Button("ğŸ§  æ¨¡å¼ï¼šè‡ªå‹•æ‰“æ€ª (Mob)", function() _G.Settings.Mode = "Mob"; _G.NekoAttack = true end)
        F_Core:Button("ğŸ›‘ åœæ­¢æ‰€æœ‰æˆ°é¬¥", function() _G.Settings.Mode = "None"; _G.NekoAttack = false end)

        -- ç’°å¢ƒå„ªåŒ–
        local TabEnv = myUI:Tab("ç’°å¢ƒå„ªåŒ–")
        local VisualSec = TabEnv:Section("è¦–è¦ºå¢å¼·")
        VisualSec:Toggle("é–‹å•Ÿè²“è²“é€è¦– (ESP)", function(s)
            _G.NekoESP = s
            if s and not _G.ESPLoaded then
                _G.ESPLoaded = true
                loadstring(game:HttpGet("https://raw.githubusercontent.com/n9wmwd7ycz-crypto/-/refs/heads/main/Esp"))()
            end
        end)
        VisualSec:Textbox("è¦–é‡è·é›¢", "128", function(v)
            local num = tonumber(v)
            if num then _G.Settings.MaxZoom = num; pcall(function() localPlayer.CameraMaxZoomDistance = num end) end
        end)

        -- ç§»å‹•å‚³é€
        local TabMove = myUI:Tab("ç§»å‹•å‚³é€")
        local M1 = TabMove:Section("è§’è‰²ç§»å‹•")
        M1:Toggle("é–‹å•Ÿç§»å‹•åŠ é€Ÿ", function(s) _G.Settings.SpeedEnabled = s end)
        M1:Toggle("é–‹å•Ÿç„¡é™è·³èº", function(s) _G.Settings.InfJump = s end)
        
        -- æœå¯¦ç³»çµ±
        local TabFruit = myUI:Tab("æœå¯¦ç³»çµ±")
        TabFruit:Section("æœå¯¦ç®¡ç†"):Toggle("è‡ªå‹•æŠ½æœå¯¦", function(s) _G.Settings.AutoBuyFruit = s end)
    end)
    
    if not success then
        warn("ğŸ¾ NEKO: ç¹ªè£½æŒ‰éˆ•æ™‚å‡ºéŒ¯å–µ: " .. tostring(err))
    end
end

-- åŸ·è¡Œç¹ªè£½
task.spawn(BuildUI)

-- [[ ğŸ¾ å•Ÿå‹•æŒ‰éˆ• ]]
local MiniBtn = Instance.new("TextButton", screenGui)
MiniBtn.Name = "NekoMainBtn"
MiniBtn.Size = UDim2.new(0, 65, 0, 65)
MiniBtn.Position = UDim2.new(0, 20, 0.5, -32)
MiniBtn.Text = "ğŸ¾"
MiniBtn.TextSize = 30
MiniBtn.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
MiniBtn.TextColor3 = Color3.fromRGB(255, 120, 180)
MiniBtn.ZIndex = 10
Instance.new("UICorner", MiniBtn).CornerRadius = UDim.new(1, 0)
myUI:AddDrag(MiniBtn)
MiniBtn.MouseButton1Click:Connect(function() myUI:Toggle() end)

print("ğŸ¾ NEKO: UI å…§å®¹å¼·åˆ¶æ¸²æŸ“å®Œæˆå–µï¼")
